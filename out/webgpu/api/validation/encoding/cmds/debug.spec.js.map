{"version":3,"sources":["../../../../../../src/webgpu/api/validation/encoding/cmds/debug.spec.ts"],"names":["description","poptions","params","makeTestGroup","ValidationTest","kEncoderTypes","g","test","combine","fn","t","encoder","finish","createEncoder","encoderType","i","pushCount","pushDebugGroup","popCount","popDebugGroup","shouldError","expectValidationError","commandBuffer","queue","submit","label","maker","insertDebugMarker"],"mappings":"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","sourcesContent":["export const description = `\nAPI validation test for debug groups and markers\n\nTest Coverage:\n  - For each encoder type (GPUCommandEncoder, GPUComputeEncoder, GPURenderPassEncoder,\n  GPURenderBundleEncoder):\n    - Test that all pushDebugGroup must have a corresponding popDebugGroup\n      - Push and pop counts of 0, 1, and 2 will be used.\n      - An error must be generated for non matching counts.\n    - Test calling pushDebugGroup with empty and non-empty strings.\n    - Test inserting a debug marker with empty and non-empty strings.\n`;\n\nimport { poptions, params } from '../../../../../common/framework/params_builder.js';\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { ValidationTest, kEncoderTypes } from '../../validation_test.js';\n\nexport const g = makeTestGroup(ValidationTest);\n\ng.test('debug_group_balanced')\n  .params(\n    params()\n      .combine(poptions('encoderType', kEncoderTypes))\n      .combine(poptions('pushCount', [0, 1, 2]))\n      .combine(poptions('popCount', [0, 1, 2]))\n  )\n  .fn(t => {\n    const { encoder, finish } = t.createEncoder(t.params.encoderType);\n    for (let i = 0; i < t.params.pushCount; ++i) {\n      encoder.pushDebugGroup(`${i}`);\n    }\n    for (let i = 0; i < t.params.popCount; ++i) {\n      encoder.popDebugGroup();\n    }\n    const shouldError = t.params.popCount !== t.params.pushCount;\n    t.expectValidationError(() => {\n      const commandBuffer = finish();\n      t.queue.submit([commandBuffer]);\n    }, shouldError);\n  });\n\ng.test('debug_group')\n  .params(\n    params()\n      .combine(poptions('encoderType', kEncoderTypes))\n      .combine(poptions('label', ['', 'group']))\n  )\n  .fn(t => {\n    const { encoder, finish } = t.createEncoder(t.params.encoderType);\n    encoder.pushDebugGroup(t.params.label);\n    encoder.popDebugGroup();\n    const commandBuffer = finish();\n    t.queue.submit([commandBuffer]);\n  });\n\ng.test('debug_marker')\n  .params(\n    params()\n      .combine(poptions('encoderType', kEncoderTypes))\n      .combine(poptions('label', ['', 'marker']))\n  )\n  .fn(t => {\n    const maker = t.createEncoder(t.params.encoderType);\n    maker.encoder.insertDebugMarker(t.params.label);\n    const commandBuffer = maker.finish();\n    t.queue.submit([commandBuffer]);\n  });\n"],"file":"debug.spec.js"}